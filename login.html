<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>CHAOS tutorials: Introduction to the CHAOS.Portal Javascript client</title>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
    <script src="../CHAOS.Portal.Client-JavaScript/src/CHAOS.Portal.Client.PortalClient.js" type="text/javascript"></script>

    <!-- <link rel="stylesheet" type="text/css" href="http://cdn.jsdelivr.net/syntaxhighlighter/3.0.83/styles/shThemeRDark.css"> -->
    <link rel="stylesheet" type="text/css" href="http://cdn.jsdelivr.net/syntaxhighlighter/3.0.83/styles/shThemeEclipse.css">
    <link href="style.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" type="text/css" href="http://cdn.jsdelivr.net/syntaxhighlighter/3.0.83/styles/shCore.css">
    <script type="text/javascript" src="http://cdn.jsdelivr.net/syntaxhighlighter/3.0.83/scripts/shCore.js"></script>
    <script type="text/javascript" src="http://cdn.jsdelivr.net/syntaxhighlighter/3.0.83/scripts/shBrushJScript.js"></script>
    <script>

      $(document).ready(function(event) {
        var codeButton = $('<div><button>Try!<\/button><\/div>');
        codeButton.children('button').click(codeEval);
        jQuery("aside#code pre code").parent().after(codeButton);


        // Calculate line numbers
        var line_count = 1;
        var code = "";
        $('aside#code pre code').each(function() {
          var pre = $(this).parent();
          pre.addClass('first-line: ' + line_count);

          line_count += $(this).text().split("\n").length

          // Save code in <code>-tag -- Google Prettify removes line-breaks
          // and so breaks the code.
          code += $(this).text();
          console.log(code);
          pre.parent().data('code', code);

          var html = $(this).html();
          pre.html(html);

          pre.addClass('brush: js');
          pre.addClass('toolbar: false');
        });

        SyntaxHighlighter.all();

      });

      function codeEval(event) {
        // console.log('Pressed!');

        var aside = $(this).parent().parent();
        console.log(aside.prop('tagName'));

        // Old code (before Prettify)
        // var code = aside.prevAll('aside').find('pre code').text();
        // code += aside.find('pre code').text();

        var code = aside.data('code');
        console.log(code);
        eval(code);

        // console.log('Unpressed!');
      }
    </script>
  </head>
  <body>
    <!-- Representation of code in HTML is for some reason weird but it seems consensus is
    <pre><code>CODE</code></pre>
    Check: http://stackoverflow.com/questions/4611591/code-vs-pre-vs-samp-for-inline-and-block-code-snippets
    -->

    <p>
      Typically a CHAOS server requires a login, such that only those (sites)
      who have been granted access can use the CHAOS database.

      Of course since Javascript is run on the client the login credentials (username/password)
      will be visible to any end-user and so the login is no longer secret.
      <!-- FIX -->
      I don't know any solution for this, so using Javascript for CHAOS
      databases that require login is strongly discouraged.
      <!-- FIX END -->

    </p>

    <aside class="code">
    <pre><code class="language-javascript">// Setup settings
var ChaosSettings = {
  "servicePath":"http://api.chaos-systems.com/",
  "clientGUID":"9f62060c-64ff-e14f-a8d5-d85a1e2e21b8",
  "autoCreateSession": "8c5cef83-0c90-a148-8166-cb88b323bdb1",
  "accessPointGUID":"C4C2B8DA-A980-11E1-814B-02CEA2621172",
  "schema": ["5906a41b-feae-48db-bfb7-714b3e105396", "00000000-0000-0000-0000-000063c30000", "00000000-0000-0000-0000-000065c30000"],
};
// Instantiate client
var client = new PortalClient(ChaosSettings.servicePath, ChaosSettings.clientGUID, ChaosSettings.autoCreateSession);</code></pre>
    </aside>

    <p>
      The <code>servicePath</code> is the URL at which the CHAOS.Portal you are going to
      interface with is set up.
    </p>
    <a class="next-page" href="javascript_login.html"></a>
    <a class="prev-page" href="javascript_intro.html"> &larr; Back up: Logging
      in </a>
    <!-- <a class="next&#45;page" href="javascript_login.html"> &#38;quot; Logging in</a> -->
  </body>
</html>

