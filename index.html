<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>CHAOS tutorials: Introduction to the CHAOS.Portal Javascript client</title>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
    <script src="../CHAOS.Portal.Client-JavaScript/src/CHAOS.Portal.Client.PortalClient.js" type="text/javascript"></script>

    <!-- <link rel="stylesheet" type="text/css" href="http://cdn.jsdelivr.net/syntaxhighlighter/3.0.83/styles/shThemeRDark.css"> -->
    <link rel="stylesheet" type="text/css" href="http://cdn.jsdelivr.net/syntaxhighlighter/3.0.83/styles/shThemeEclipse.css">
    <link href="style.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" type="text/css" href="http://cdn.jsdelivr.net/syntaxhighlighter/3.0.83/styles/shCore.css">
    <script type="text/javascript" src="http://cdn.jsdelivr.net/syntaxhighlighter/3.0.83/scripts/shCore.js"></script>
    <script type="text/javascript" src="http://cdn.jsdelivr.net/syntaxhighlighter/3.0.83/scripts/shBrushJScript.js"></script>
    <script type="text/javascript"
      src="http://cdn.jsdelivr.net/syntaxhighlighter/3.0.83/scripts/shBrushXml.js"></script>
    <script>

      $(document).ready(function(event) {

        // Calculate line numbers
        var setup_code = "";
        var line_count = 0;
        $('aside.code pre code#setup.language-javascript').each(function() {
          line_count = $(this).text().split("\n").length + 1
          setup_code = $(this).text();
        });

        // $('aside.code pre code[id!="setup"].language-javascript').each(function() {
        $('aside.code pre code.language-javascript').each(function() {
          var pre = $(this).parent();

          if ($(this).attr("id") != "setup") {
            pre.addClass('first-line: ' + line_count);

            // Add Javascript evaluate button
            var codeButton = $('<div class="try-code"><button>Try!<\/button><\/div>');
            codeButton.children('button').click(codeEval);
            pre.after(codeButton);

            // Save code in <code>-tag -- Google Prettify removes line-breaks
            // and so breaks the code.
            var code = setup_code + $(this).text();
            console.log(code);
            pre.parent().data('code', code);
          }


          // Remove code element - otherwise SyntaxHighlighter doesn't work
          var html = $(this).html();
          pre.html(html);

          pre.addClass('brush: js');
          pre.addClass('toolbar: false');
        });

        $('aside.code pre code.language-html').each(function() {
          var pre = $(this).parent();
          var html = $(this).html();
          pre.html(html);

          pre.addClass('brush: html');
          pre.addClass('toolbar: false');
        });

        SyntaxHighlighter.all();

      });

      function codeEval(event) {
        // console.log('Pressed!');

        var aside = $(this).parent().parent();
        console.log(aside.prop('tagName'));

        // Old code (before Prettify)
        // var code = aside.prevAll('aside').find('pre code').text();
        // code += aside.find('pre code').text();

        var code = aside.data('code');
        console.log(code);
        eval(code);

        // console.log('Unpressed!');
      }
    </script>
  </head>
  <body>
    <!-- Representation of code in HTML is for some reason weird but it seems consensus is
    <pre><code>CODE</code></pre>
    Check: http://stackoverflow.com/questions/4611591/code-vs-pre-vs-samp-for-inline-and-block-code-snippets
    -->

    <div id="body-column">
      <h1>Tutorial: CHAOS.Portal Javascript Client</h1>
      <h2>The first steps</h2>
      <p id="intro">
        The <dfn>CHAOS.Portal Javascript Client</dfn> is a communication client for
        <dfn>CHAOS.Portal</dfn><br>
        <dfn>CHAOS.Portal</dfn> is the web API for <a
          href="http://chaos-community.org"><dfn><abbr title="Cultural Heritage
            Archiving Open System">CHAOS</abbr></dfn></a>.<br>
      </p>
      <p>
        Javascript client for CHAOS.Portal is one of the easiest ways to start
        using CHAOS.<br>
      </p>
      <h3>Tutorials</h3>
      <ol>
        <li><a href="intro.html">The Basics</a></li>
        <li>Metadata and schemas</li>
        <li><a href="login.html">Logging in</a></li>
      </ol>


      <footer>
        <!-- <a class="prev&#45;page" href="javascript_login.html">&#38;larr; Back up: Tutorials -->
        <!--   overview</a> -->
        <a class="next-page" href="intro.html">Next up: The Basics
          &rarr;</a>
        <!-- &raquo; / &laquo; -->
      </footer>
    </div>
  </body>
</html>
